=== POWERSHELL ===

*** get uptime ***

	(get-date)-(gcim Win32_OperatingSystem).LastBootUpTime
	
*** run sql ***

	$SQLServer = "aws-sql2"
	$db3 = "abcv2"
	$uid = "sa"
	$pwd = "SgQ>RQZ.p-SU9J#rrV{3L,8"
	$query = "select top 5 * from itm_item order by id desc"

	# hard-coded command 
	Invoke-Sqlcmd -ServerInstance $SQLServer -Database $db3 -Username $uid -Password $pwd -Query $query | Export-Csv "testoutput.txt" -Delimiter "," -NoTypeInformation
	
	# Skip the headers
	Invoke-Sqlcmd -ServerInstance $SQLServer -Database $db3 -Username $uid -Password $pwd -Query $query | ConvertTo-Csv -NoTypeInformation | Select-Object -Skip 1 | Set-Content "testoutput.txt"

	# command in external file 
	Invoke-Sqlcmd -ServerInstance $SQLServer -Database $db3 -Username $uid -Password $pwd -InputFile "c:\abc\acr_import\abc.sql" | Export-Csv "c:\abc\acr_import\acr_projects.txt" -Delimiter "," -NoTypeInformation

*** event log ***

	Get-EventLog -List 
	Get-EventLog -LogName Application -Newest 50 -Source AbcHbClient -EntryType Error 

*** remote execution issues ***

	Check execution policy: powershell Get-ExecutionPolicy -List 
	Set the execution policy: powershell Set-ExecutionPolicy remotesigned -Force 
	Work around: From command prompt - powershell <PowershellCommand> <Params> (cmd powershell Get-Service)

*** Creating Files and Folders ***

	File (current path): New-Item -Path . -Name "filename" -ItemType "file" -Value "file content"
	Folder: New-Item -Path "c:\" -Name "FolderName" -ItemType "directory"

*** IIS ***

	Get-IISAppPool
	Restart-WebAppPool <AppPoolName>

